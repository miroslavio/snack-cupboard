# Snack Cupboard — Local Development

This repository is a small full-stack app for tracking snack/drink purchases for staff.

Quick overview

- Frontend: React + Vite (client)
- Backend: Node.js + Express (server)
- Database: SQLite (file at `data/snacks.db`)

Local run (development)

1. Install dependencies (root + client):

```bash
# from repo root
npm install
cd client
npm install
cd ..
```

2. Start dev servers (server + client). From repo root run:

```bash
npm run dev
```

This runs both:

- Server: <http://localhost:3001> (Express)
- Client (Vite): <http://localhost:5173> (React app)

Notes

- In development Vite serves the client on port 5173. Express static fallback is only used for production when `client/dist` exists. The server may log a 404 for the production `dist` file while developing — this is normal.
- DB file is created at `data/snacks.db` on first run.

Admin tasks

- Import staff CSV (headers): `StaffID,Initials,Surname,Forename`
- Import items CSV (headers): `name,price`

Example CSV (staff):

```
StaffID,Initials,Surname,Forename
001,AB,Smith,Alan
002,CD,Jones,Cara
```

Example CSV (items):

```
name,price
Chocolate Bar,1.25
Bottled Water,0.90
```

API Endpoints (dev)

- GET /api/health — health check
- GET /api/staff?search= — list staff (alphabetical)
- POST /api/staff/import — import staff CSV (text/csv body)
- GET /api/items?search= — list items
- POST /api/items — add item { name, price }
- POST /api/items/import-csv — import items CSV (text/csv body)
- POST /api/purchases — record purchase { staffId, items: [{ id, quantity, price }, ...] }
- GET /api/purchases — list purchases
- GET /api/purchases/export/csv — download purchases CSV
- GET /api/purchases/summary/by-staff — summary totals per staff

Troubleshooting

- If ports 3001 or 5173 are in use, stop those processes or change ports.
- To produce a production build:
  - `cd client && npm run build`
  - Start server normally (`npm start`) — Express serves `client/dist`.

If you want, I can:

- Add a small `.env.example` and Docker support
- Add automated tests for API routes

---
Generated by the development helper — let me know if you'd like any changes to the README or the background server setup.
